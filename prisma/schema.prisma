generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Book {
  id                        Int                       @id @unique @default(autoincrement())
  user_id                   Int
  title                     String
  description               String
  status                    String?                   @db.VarChar(10)
  picture                   String[]
  in_libary                 Boolean                   @default(false)
  pickup                    String?
  datetime                  DateTime?                  @db.Date
  req_count                 Int?                       
  User                      User                      @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "book_user_id")
  category                  Category[]
  Review_Book               Review_Book[]
  Trade_Trade_book_idToBook Trade[]                   @relation("Trade_book_idToBook")
  Wishlist                  Wishlist[]
}

model Review_Book {
  id       Int     @default(autoincrement())
  book_id  Int
  user_id  Int
  title    String  @db.VarChar(20)
  score    Decimal @db.Decimal(1, 0)
  describe String?
  Book     Book    @relation(fields: [book_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "review_book-book_id")
  User     User    @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "review_book-user_id")

  @@id([id, book_id, user_id])
}

model Trade {
  id                        Int      @default(autoincrement())
  book_id                   Int
  owner_id                  Int
  req_user_id               Int
  datetime                  DateTime @db.Date
  return_date               String   @db.VarChar(6)
  status                    String   @db.VarChar(10)
  pickup_req                String?
  Book_Trade_book_idToBook  Book     @relation("Trade_book_idToBook", fields: [book_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "trade-book_id")
  User_Trade_owner_idToUser User     @relation("Trade_owner_idToUser", fields: [owner_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "trade-owner_id")
  User                      User     @relation(fields: [req_user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "trade-req_user_id")

  @@id([id, book_id, owner_id, req_user_id])
}

model User {
  id                                        Int           @id @default(autoincrement())
  username                                  String        @unique @db.VarChar(20)
  password                                  String
  email                                     String        @unique @db.VarChar(40)
  first_name                                String        @db.VarChar(20)
  last_name                                 String        @db.VarChar(20)
  profile_picture                           String?
  phone_number                              String        @unique @db.VarChar(10)
  card_id                                   String        @unique @db.VarChar(13)
  instagram                                 String?       @db.VarChar(20)
  facebook                                  String?
  line                                      String?       @db.VarChar(20)
  address                                   String[]
  isAdmin                                   Boolean       @default(false)
  Book                                      Book[]
  Review_Book                               Review_Book[]
  Review_User_Review_User_reviewer_idToUser Review_User[] @relation("Review_User_reviewer_idToUser")
  Review_User_Review_User_user_idToUser     Review_User[] @relation("Review_User_user_idToUser")
  Trade_Trade_owner_idToUser                Trade[]       @relation("Trade_owner_idToUser")
  Trade                                     Trade[]
  Wishlist                                  Wishlist[]
}

model Category {
  id                      Int                       @id @default(autoincrement())
  name                    String                    @db.VarChar(20)
  book                    Book[]
}


model Review_User {
  id                                 Int     @default(autoincrement())
  user_id                            Int
  reviewer_id                        Int
  title                              String
  score                              Decimal @db.Decimal(1, 0)
  describe                           String?
  User_Review_User_reviewer_idToUser User    @relation("Review_User_reviewer_idToUser", fields: [reviewer_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "review_user-reviewer_id")
  User_Review_User_user_idToUser     User    @relation("Review_User_user_idToUser", fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "review_user-user_id")

  @@id([id, user_id, reviewer_id])
}

model Wishlist {
  id      Int  @default(autoincrement())
  user_id Int
  book_id Int
  Book    Book @relation(fields: [book_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "wishlist-book_id")
  User    User @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "wishlist-user_id")

  @@id([id, user_id, book_id])
}


